{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/ivopascoal/Desktop/Naughty/naughty_front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _regeneratorRuntime from\"/Users/ivopascoal/Desktop/Naughty/naughty_front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/ivopascoal/Desktop/Naughty/naughty_front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/ivopascoal/Desktop/Naughty/naughty_front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _templateObject,_templateObject2,_templateObject3;import BigNumber from'bignumber.js';import React,{useCallback,useMemo,useState}from'react';import styled from'styled-components';import{Button,Modal}from'@pancakeswap-libs/uikit';import{getFullDisplayBalance}from'utils/formatBalance';import TicketInput from'components/TicketInput';import ModalActions from'components/ModalActions';import{useMultiBuyLottery,useMaxNumber}from'hooks/useBuyLottery';import useI18n from'hooks/useI18n';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var BuyTicketModal=function BuyTicketModal(_ref){var max=_ref.max,onDismiss=_ref.onDismiss;var _useState=useState('1'),_useState2=_slicedToArray(_useState,2),val=_useState2[0],setVal=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),pendingTx=_useState4[0],setPendingTx=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),setRequestedBuy=_useState6[1];var TranslateString=useI18n();var fullBalance=useMemo(function(){return getFullDisplayBalance(max);},[max]);var maxTickets=useMemo(function(){return parseInt(getFullDisplayBalance(max.div(new BigNumber(10))));},[max]);var handleChange=function handleChange(e){return setVal(e.currentTarget.value);};var _useMultiBuyLottery=useMultiBuyLottery(),onMultiBuy=_useMultiBuyLottery.onMultiBuy;var maxNumber=useMaxNumber();var handleBuy=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var length,_numbers,txHash;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setRequestedBuy(true);length=parseInt(val);// @ts-ignore\n// eslint-disable-next-line prefer-spread\n_numbers=Array.apply(null,{length:length}).map(function(){return[Math.floor(Math.random()*maxNumber)+1,Math.floor(Math.random()*maxNumber)+1,Math.floor(Math.random()*maxNumber)+1,Math.floor(Math.random()*maxNumber)+1];});_context.next=6;return onMultiBuy('10',_numbers);case 6:txHash=_context.sent;// user rejected tx or didn't go thru\nif(txHash){setRequestedBuy(false);}_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);})),[onMultiBuy,setRequestedBuy,maxNumber,val]);var handleSelectMax=useCallback(function(){if(Number(maxTickets)>50){setVal('50');}else{setVal(maxTickets.toString());}},[maxTickets]);var cakeCosts=function cakeCosts(amount){return+amount*10;};return/*#__PURE__*/_jsxs(Modal,{title:TranslateString(450,'Enter amount of tickets to buy'),onDismiss:onDismiss,children:[/*#__PURE__*/_jsx(TicketInput,{value:val,onSelectMax:handleSelectMax,onChange:handleChange,max:fullBalance,symbol:\"TICKET\",availableSymbol:\"CAKE\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Tips,{children:TranslateString(456,'Your amount must be a multiple of 10 CAKE')}),/*#__PURE__*/_jsx(Tips,{children:TranslateString(458,'1 Ticket = 10 CAKE')})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Announce,{children:TranslateString(478,'Ticket purchases are final. Your CAKE cannot be returned to you after buying tickets.')}),/*#__PURE__*/_jsx(Final,{children:TranslateString(460,\"You will spend: \".concat(cakeCosts(val),\" PASTA\"))})]}),/*#__PURE__*/_jsxs(ModalActions,{children:[/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"secondary\",onClick:onDismiss,children:TranslateString(462,'Cancel')}),/*#__PURE__*/_jsx(Button,{id:\"lottery-buy-complete\",fullWidth:true,disabled:pendingTx||parseInt(val)>Number(maxTickets)||parseInt(val)>50||parseInt(val)<1,onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setPendingTx(true);_context2.next=3;return handleBuy();case 3:setPendingTx(false);onDismiss();case 5:case\"end\":return _context2.stop();}}},_callee2);})),children:pendingTx?TranslateString(488,'Pending Confirmation'):TranslateString(464,'Confirm')})]})]});};export default BuyTicketModal;var Tips=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  margin-left: 0.4em;\\n  font-size: 14px;\\n  font-weight: 600;\\n  color: \",\";\\n\"])),function(props){return props.theme.colors.primary;});var Final=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  margin-top: 1em;\\n  text-align: center;\\n  font-size: 20px;\\n  font-weight: 600;\\n  color: \",\";\\n\"])),function(props){return props.theme.colors.primary;});var Announce=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  margin-top: 1em;\\n  margin-left: 0.4em;\\n  color: #ed4b9e;\\n\"])));","map":{"version":3,"sources":["/Users/ivopascoal/Desktop/Naughty/naughty_front/src/views/Lottery/components/TicketCard/BuyTicketModal.tsx"],"names":["BigNumber","React","useCallback","useMemo","useState","styled","Button","Modal","getFullDisplayBalance","TicketInput","ModalActions","useMultiBuyLottery","useMaxNumber","useI18n","BuyTicketModal","max","onDismiss","val","setVal","pendingTx","setPendingTx","setRequestedBuy","TranslateString","fullBalance","maxTickets","parseInt","div","handleChange","e","currentTarget","value","onMultiBuy","maxNumber","handleBuy","length","numbers","Array","apply","map","Math","floor","random","txHash","console","error","handleSelectMax","Number","toString","cakeCosts","amount","Tips","props","theme","colors","primary","Final","Announce"],"mappings":"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","sourcesContent":["import BigNumber from 'bignumber.js'\r\nimport React, { useCallback, useMemo, useState } from 'react'\r\nimport styled from 'styled-components'\r\nimport { Button, Modal } from '@pancakeswap-libs/uikit'\r\nimport { getFullDisplayBalance } from 'utils/formatBalance'\r\nimport TicketInput from 'components/TicketInput'\r\nimport ModalActions from 'components/ModalActions'\r\nimport { useMultiBuyLottery, useMaxNumber } from 'hooks/useBuyLottery'\r\nimport useI18n from 'hooks/useI18n'\r\n\r\ninterface BuyTicketModalProps {\r\n  max: BigNumber\r\n  onConfirm?: (amount: string, numbers: Array<number>) => void\r\n  onDismiss?: () => void\r\n  tokenName?: string\r\n}\r\n\r\nconst BuyTicketModal: React.FC<BuyTicketModalProps> = ({ max, onDismiss }) => {\r\n  const [val, setVal] = useState('1')\r\n  const [pendingTx, setPendingTx] = useState(false)\r\n  const [, setRequestedBuy] = useState(false)\r\n  const TranslateString = useI18n()\r\n  const fullBalance = useMemo(() => {\r\n    return getFullDisplayBalance(max)\r\n  }, [max])\r\n\r\n  const maxTickets = useMemo(() => {\r\n    return parseInt(getFullDisplayBalance(max.div(new BigNumber(10))))\r\n  }, [max])\r\n\r\n  const handleChange = (e: React.FormEvent<HTMLInputElement>) => setVal(e.currentTarget.value)\r\n\r\n  const { onMultiBuy } = useMultiBuyLottery()\r\n  const maxNumber = useMaxNumber()\r\n  const handleBuy = useCallback(async () => {\r\n    try {\r\n      setRequestedBuy(true)\r\n      const length = parseInt(val)\r\n      // @ts-ignore\r\n      // eslint-disable-next-line prefer-spread\r\n      const numbers = Array.apply(null, { length }).map(() => [\r\n        Math.floor(Math.random() * maxNumber) + 1,\r\n        Math.floor(Math.random() * maxNumber) + 1,\r\n        Math.floor(Math.random() * maxNumber) + 1,\r\n        Math.floor(Math.random() * maxNumber) + 1,\r\n      ])\r\n      const txHash = await onMultiBuy('10', numbers)\r\n      // user rejected tx or didn't go thru\r\n      if (txHash) {\r\n        setRequestedBuy(false)\r\n      }\r\n    } catch (e) {\r\n      console.error(e)\r\n    }\r\n  }, [onMultiBuy, setRequestedBuy, maxNumber, val])\r\n\r\n  const handleSelectMax = useCallback(() => {\r\n    if (Number(maxTickets) > 50) {\r\n      setVal('50')\r\n    } else {\r\n      setVal(maxTickets.toString())\r\n    }\r\n  }, [maxTickets])\r\n\r\n  const cakeCosts = (amount: string): number => {\r\n    return +amount * 10\r\n  }\r\n  return (\r\n    <Modal title={TranslateString(450, 'Enter amount of tickets to buy')} onDismiss={onDismiss}>\r\n      <TicketInput\r\n        value={val}\r\n        onSelectMax={handleSelectMax}\r\n        onChange={handleChange}\r\n        max={fullBalance}\r\n        symbol=\"TICKET\"\r\n        availableSymbol=\"CAKE\"\r\n      />\r\n      <div>\r\n        <Tips>{TranslateString(456, 'Your amount must be a multiple of 10 CAKE')}</Tips>\r\n        <Tips>{TranslateString(458, '1 Ticket = 10 CAKE')}</Tips>\r\n      </div>\r\n      <div>\r\n        <Announce>\r\n          {TranslateString(\r\n            478,\r\n            'Ticket purchases are final. Your CAKE cannot be returned to you after buying tickets.',\r\n          )}\r\n        </Announce>\r\n        <Final>{TranslateString(460, `You will spend: ${cakeCosts(val)} PASTA`)}</Final>\r\n      </div>\r\n      <ModalActions>\r\n        <Button fullWidth variant=\"secondary\" onClick={onDismiss}>\r\n          {TranslateString(462, 'Cancel')}\r\n        </Button>\r\n        <Button\r\n          id=\"lottery-buy-complete\"\r\n          fullWidth\r\n          disabled={pendingTx || parseInt(val) > Number(maxTickets) || parseInt(val) > 50 || parseInt(val) < 1}\r\n          onClick={async () => {\r\n            setPendingTx(true)\r\n            await handleBuy()\r\n            setPendingTx(false)\r\n            onDismiss()\r\n          }}\r\n        >\r\n          {pendingTx ? TranslateString(488, 'Pending Confirmation') : TranslateString(464, 'Confirm')}\r\n        </Button>\r\n      </ModalActions>\r\n    </Modal>\r\n  )\r\n}\r\n\r\nexport default BuyTicketModal\r\n\r\nconst Tips = styled.div`\r\n  margin-left: 0.4em;\r\n  font-size: 14px;\r\n  font-weight: 600;\r\n  color: ${(props) => props.theme.colors.primary};\r\n`\r\n\r\nconst Final = styled.div`\r\n  margin-top: 1em;\r\n  text-align: center;\r\n  font-size: 20px;\r\n  font-weight: 600;\r\n  color: ${(props) => props.theme.colors.primary};\r\n`\r\nconst Announce = styled.div`\r\n  margin-top: 1em;\r\n  margin-left: 0.4em;\r\n  color: #ed4b9e;\r\n`\r\n"]},"metadata":{},"sourceType":"module"}