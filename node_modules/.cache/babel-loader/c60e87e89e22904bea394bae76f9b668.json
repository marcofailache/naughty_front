{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ivopascoal/Desktop/Naughty/naughty_front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/ivopascoal/Desktop/Naughty/naughty_front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/ivopascoal/Desktop/Naughty/naughty_front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/ivopascoal/Desktop/Naughty/naughty_front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject;import React,{useState,useEffect}from'react';import styled from'styled-components';import{ButtonMenu,ButtonMenuItem}from'@pancakeswap-libs/uikit';import{useWallet}from'@binance-chain/bsc-use-wallet';import PastLotteryDataContext from'contexts/PastLotteryDataContext';import{getLotteryIssueIndex}from'utils/lotteryUtils';import useI18n from'hooks/useI18n';import{useLottery}from'hooks/useContract';import Page from'components/layout/Page';import Hero from'./components/Hero';import Divider from'./components/Divider';import NextDrawPage from'./NextDrawPage';import PastDrawsPage from'./PastDrawsPage';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Wrapper=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  margin-bottom: 32px;\\n\"])));var Lottery=function Lottery(){var lotteryContract=useLottery();var _useWallet=useWallet(),account=_useWallet.account;var TranslateString=useI18n();var _useState=useState(0),_useState2=_slicedToArray(_useState,2),activeIndex=_useState2[0],setActiveIndex=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),historyData=_useState4[0],setHistoryData=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),historyError=_useState6[0],setHistoryError=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),currentLotteryNumber=_useState8[0],setCurrentLotteryNumber=_useState8[1];var _useState9=useState(1),_useState10=_slicedToArray(_useState9,2),mostRecentLotteryNumber=_useState10[0],setMostRecentLotteryNumber=_useState10[1];useEffect(function(){fetch(\"https://api.pastafinance.com/api/lotteryHistory\").then(function(response){return response.json();}).then(function(data){return setHistoryData(data);}).catch(function(){setHistoryError(true);});},[]);useEffect(function(){var getInitialLotteryIndex=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var index,previousLotteryNumber;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getLotteryIssueIndex(lotteryContract);case 2:index=_context.sent;previousLotteryNumber=index-1;setCurrentLotteryNumber(index);setMostRecentLotteryNumber(previousLotteryNumber);case 6:case\"end\":return _context.stop();}}},_callee);}));return function getInitialLotteryIndex(){return _ref.apply(this,arguments);};}();if(account&&lotteryContract){getInitialLotteryIndex();}},[account,lotteryContract]);var handleClick=function handleClick(index){setActiveIndex(index);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Hero,{}),/*#__PURE__*/_jsxs(Page,{children:[/*#__PURE__*/_jsx(Wrapper,{children:/*#__PURE__*/_jsxs(ButtonMenu,{activeIndex:activeIndex,onClick:handleClick,size:\"sm\",variant:\"subtle\",children:[/*#__PURE__*/_jsx(ButtonMenuItem,{children:TranslateString(999,'Next draw')}),/*#__PURE__*/_jsx(ButtonMenuItem,{children:TranslateString(999,'Past draws')})]})}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(PastLotteryDataContext.Provider,{value:{historyError:historyError,historyData:historyData,mostRecentLotteryNumber:mostRecentLotteryNumber,currentLotteryNumber:currentLotteryNumber},children:activeIndex===0?/*#__PURE__*/_jsx(NextDrawPage,{}):/*#__PURE__*/_jsx(PastDrawsPage,{})})]})]});};export default Lottery;","map":{"version":3,"sources":["/Users/ivopascoal/Desktop/Naughty/naughty_front/src/views/Lottery/Lottery.tsx"],"names":["React","useState","useEffect","styled","ButtonMenu","ButtonMenuItem","useWallet","PastLotteryDataContext","getLotteryIssueIndex","useI18n","useLottery","Page","Hero","Divider","NextDrawPage","PastDrawsPage","Wrapper","div","Lottery","lotteryContract","account","TranslateString","activeIndex","setActiveIndex","historyData","setHistoryData","historyError","setHistoryError","currentLotteryNumber","setCurrentLotteryNumber","mostRecentLotteryNumber","setMostRecentLotteryNumber","fetch","then","response","json","data","catch","getInitialLotteryIndex","index","previousLotteryNumber","handleClick"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport styled from 'styled-components'\r\nimport { ButtonMenu, ButtonMenuItem } from '@pancakeswap-libs/uikit'\r\nimport { useWallet } from '@binance-chain/bsc-use-wallet'\r\nimport PastLotteryDataContext from 'contexts/PastLotteryDataContext'\r\nimport { getLotteryIssueIndex } from 'utils/lotteryUtils'\r\nimport useI18n from 'hooks/useI18n'\r\nimport { useLottery } from 'hooks/useContract'\r\nimport Page from 'components/layout/Page'\r\nimport Hero from './components/Hero'\r\nimport Divider from './components/Divider'\r\nimport NextDrawPage from './NextDrawPage'\r\nimport PastDrawsPage from './PastDrawsPage'\r\n\r\nconst Wrapper = styled.div`\r\n  position: relative;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  margin-bottom: 32px;\r\n`\r\n\r\nconst Lottery: React.FC = () => {\r\n  const lotteryContract = useLottery()\r\n  const { account } = useWallet()\r\n  const TranslateString = useI18n()\r\n  const [activeIndex, setActiveIndex] = useState(0)\r\n  const [historyData, setHistoryData] = useState([])\r\n  const [historyError, setHistoryError] = useState(false)\r\n  const [currentLotteryNumber, setCurrentLotteryNumber] = useState(0)\r\n  const [mostRecentLotteryNumber, setMostRecentLotteryNumber] = useState(1)\r\n\r\n  useEffect(() => {\r\n    fetch(`https://api.pastafinance.com/api/lotteryHistory`)\r\n      .then((response) => response.json())\r\n      .then((data) => setHistoryData(data))\r\n      .catch(() => {\r\n        setHistoryError(true)\r\n      })\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    const getInitialLotteryIndex = async () => {\r\n      const index = await getLotteryIssueIndex(lotteryContract)\r\n      const previousLotteryNumber = index - 1\r\n\r\n      setCurrentLotteryNumber(index)\r\n      setMostRecentLotteryNumber(previousLotteryNumber)\r\n    }\r\n\r\n    if (account && lotteryContract) {\r\n      getInitialLotteryIndex()\r\n    }\r\n  }, [account, lotteryContract])\r\n\r\n  const handleClick = (index) => {\r\n    setActiveIndex(index)\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Hero />\r\n      <Page>\r\n        <Wrapper>\r\n          <ButtonMenu activeIndex={activeIndex} onClick={handleClick} size=\"sm\" variant=\"subtle\">\r\n            <ButtonMenuItem>{TranslateString(999, 'Next draw')}</ButtonMenuItem>\r\n            <ButtonMenuItem>{TranslateString(999, 'Past draws')}</ButtonMenuItem>\r\n          </ButtonMenu>\r\n        </Wrapper>\r\n        <Divider />\r\n        <PastLotteryDataContext.Provider\r\n          value={{ historyError, historyData, mostRecentLotteryNumber, currentLotteryNumber }}\r\n        >\r\n          {activeIndex === 0 ? <NextDrawPage /> : <PastDrawsPage />}\r\n        </PastLotteryDataContext.Provider>\r\n      </Page>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Lottery\r\n"]},"metadata":{},"sourceType":"module"}